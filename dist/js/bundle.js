!function t(i,e,n){function s(r,o){if(!e[r]){if(!i[r]){var h="function"==typeof require&&require;if(!o&&h)return h(r,!0);if(a)return a(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=e[r]={exports:{}};i[r][0].call(d.exports,function(t){var e=i[r][1][t];return s(e?e:t)},d,d.exports,t,i,e,n)}return e[r].exports}for(var a="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,i,e){function n(){function t(){var e=s(),n=e-i.last_timestamp;i.update(n),i.last_timestamp=e,requestAnimationFrame(t)}var i=new a;window.the_game=i,i.start_time=s(),t()}var s=t("./utils.js").what_time_is_it,a=t("./minesweeper.js");n()},{"./minesweeper.js":4,"./utils.js":7}],2:[function(t,i,e){function n(t){this.renderer=PIXI.autoDetectRenderer(this.width,this.height),this.renderer.backgroundColor=this.BACKGROUND_COLOUR||10066329,this.stage=new PIXI.Container,this.canvas=$(".game_canvas"),this.canvas.append(this.renderer.view),this.game_states=t,this.state_name=this.game_states.__initial__,this.transition_arguments=null}n.prototype={start_time:0,last_timestamp:0,running_time:0,game_objects:[],update:function(t){this.state&&this.state.update(t);for(var i=0;i<this.game_objects.length;i+=1){var e=this.game_objects[i],n=e.update(t);for(var s in n)this.state.handle_event(s,e,n[s])||console.warn("Unhandled Event '"+s+"'.")}if(this.renderer.render(this.stage),this.transitioning){var a=this.game_states[this.state_name];this.state=new a(this,this.transition_arguments),this.transition_arguments=null,this.transitioning=!1}this.running_time+=t},state:null,state_name:"",transitioning:!0,transition:function(t,i){this.state_name=t,this.transition_arguments=i,this.transitioning=!0},log_element:null,log:function(t){this.log_element||(this.log_element=$(".game_log"));var i=$('<div class="log_entry">'+t+"</div>");this.log_element.append(i)},reset:function(){this.log_element.empty(),this.game_objects=[]}},i.exports=n},{}],3:[function(t,i,e){function n(t){this.game=t}n.prototype={name:"Base State",game:null,update:function(t){},event_handlers:[],handle_event:function(t,i,e){var n=this.event_handlers[t];return!!n&&(n.call(this,i,e),!0)}},i.exports=n},{}],4:[function(t,i,e){function n(){this.GRID_COLUMNS=16,this.GRID_ROWS=16,this.MINE_COUNT=32;this.width=this.GRID_COLUMNS*a.TILE_WIDTH,this.height=this.GRID_ROWS*a.TILE_HEIGHT,this.cheats={},this.grid=null,this.mines=null,this.flags=null,this.remaining_mines=0,s.call(this,r),this.reset=function(){for(var t=0;t<this.GRID_COLUMNS;t+=1)for(var i=0;i<this.GRID_ROWS;i+=1){var e=this.grid[t][i];e.visible=!1,this.stage.removeChild(e),this.grid[t][i]=null}s.prototype.reset.apply(this)},this.addTile=function(t){this.grid[t.column][t.row]=t,this.stage.addChild(t),this.game_objects.push(t)},this.get_adjacent_tiles=function(t,i){var e=[],n=t-1,s=t+1,a=i-1,r=i+1,o=n>=0,h=s<this.GRID_COLUMNS,l=a>=0,d=r<this.GRID_ROWS;return o&&(l&&e.push(this.grid[n][a]),e.push(this.grid[n][i]),d&&e.push(this.grid[n][r])),l&&e.push(this.grid[t][a]),d&&e.push(this.grid[t][r]),h&&(l&&e.push(this.grid[s][a]),e.push(this.grid[s][i]),d&&e.push(this.grid[s][r])),e},this.reveal_area=function(t){for(var i=[t];i.length;){var e=i.pop();if(!e.adjacent)for(var n=this.get_adjacent_tiles(e.column,e.row),s=0;s<n.length;s+=1){var a=n[s];a.excavated||(a.reveal(),a.adjacent||i.push(a))}}}}var s=t("./game.js"),a=t("./tile.js"),r=t("./states.js");n.prototype=Object.create(s.prototype),i.exports=n},{"./game.js":2,"./states.js":5,"./tile.js":6}],5:[function(t,i,e){function n(t){h.call(this,t),this.name="loading_assets",this.event_handlers={},this.loading_started=!1,this.loading_done=!1,this.update=function(t){function i(){e.loading_done=!0}if(this.loading_started)this.loading_done?(console.log("done loading assets!"),this.game.transition("initializing")):console.log("still loading...");else{console.log("Loading assets...");var e=this,n=[],s=["/static/sprites/sprites.json"];PIXI.loader.add(n).add(s).load(i),this.loading_started=!0}}}function s(t){h.call(this,t),this.name="initializing",this.event_handlers={},this.update=function(i){t.grid=[],t.mines=[],t.flags=[];for(var e=0;e<t.GRID_COLUMNS;e+=1){t.grid[e]=[];for(var n=0;n<t.GRID_ROWS;n+=1){var s=new l(e,n);t.addTile(s)}}t.remaining_mines=0;for(var a=0;a<t.MINE_COUNT;a+=1)for(var r=!1;!r;){var e=o(t.GRID_COLUMNS),n=o(t.GRID_ROWS),s=t.grid[e][n];if(!s.mined){s.mined=!0;var h=t.get_adjacent_tiles(e,n);for(var d in h){var g=h[d];g.increment_adjacent()}t.remaining_mines+=1,t.mines.push(s),r=!0}}t.log("Welcome to MikeSweeper!"),t.log("There are "+t.remaining_mines+" mines."),t.transition("main")}}function a(t){function i(i,arguments){t.log(arguments.message)}function e(i,arguments){t.transition("game_over")}function n(i,arguments){t.reveal_area(i)}function s(i){i.flagged?t.flags.push(i):t.flags.splice(t.flags.indexOf(i),1),i.mined&&(t.remaining_mines+=i.flagged?-1:1),t.remaining_mines<=0&&t.transition("game_over")}function a(t,i){i?t.flag():t.dig()}h.call(this,t),this.name="main",this.event_handlers={log:i,exploded:e,reveal_area:n,flagged:s,tile_clicked:a},this.update=function(t){console.log("main")}}function r(t){function i(i){t.reset(),t.transition("initializing")}h.call(this,t),this.name="game_over",t.remaining_mines?t.log("You blew up!"):t.log("Cool! You got them all!"),t.log("Click on the field to play again.");for(var e in t.mines)t.mines[e].reveal_mine();this.event_handlers={tile_clicked:i}}var o=t("./utils.js").random_int,h=t("./game_state.js"),l=t("./tile.js"),d={};n.prototype=Object.create(h.prototype),d.loading_assets=n,s.prototype=Object.create(h.prototype),d.initializing=s,a.prototype=Object.create(h.prototype),d.main=a,r.prototype=Object.create(h.prototype),d.game_over=r,d.__initial__="loading_assets",i.exports=d},{"./game_state.js":3,"./tile.js":6,"./utils.js":7}],6:[function(t,i,e){function n(t,i){this.events={};var e=s["ground.png"],n=s["excavated.png"],r=s["mine.png"],o=s["exploded.png"];PIXI.Container.call(this);var h=new PIXI.Sprite(e);this.ground_sprite=h,this.addChild(h);var l=new PIXI.Sprite(r);l.visible=!1,this.addChild(l);var d=new PIXI.Sprite(s["flag.png"]);d.visible=!1,this.addChild(d);var g=new PIXI.Sprite(s["highlight.png"]);g.visible=!1,this.addChild(g);var c=new PIXI.Text("");c.visible=!1,this.addChild(c),this.column=t,this.x=a*t,this.row=i,this.y=a*i,this.excavated=!1,this.mined=!1,this.adjacent=0,this.flagged=!1,this.update=function(t){var i=this.events;return this.events={},i},this.interactive=!0,this.click=function(t){this.events.tile_clicked=t.data.originalEvent.shiftKey},this.mouseover=function(){g.visible=!0},this.mouseout=function(){g.visible=!1},this.increment_adjacent=function(){this.adjacent+=1,c.text=""+this.adjacent,c.x=(this.width-c.width)/2,c.y=(this.height-c.height)/2},this.reveal=function(){this.excavated=!0,h.texture=n,this.mined?l.visible=!0:this.adjacent&&(c.visible=!0)},this.dig=function(){this.reveal(),this.mined?(l.texture=o,l.visible=!0,this.events.exploded=!0):this.adjacent||(this.events.reveal_area=!0)},this.flag=function(){this.flagged=!this.flagged,d.visible=this.flagged,this.events.flagged={state:this.flagged}},this.reveal_mine=function(){this.mined&&this.reveal()},this.name="("+this.column+","+this.row+")",this.stringify=function(){return"Tile("+this.column+","+this.row+")["+this.adjacent+"]"+(this.mined?"*":"")}}var s=PIXI.utils.TextureCache,a=32,r=32;n.prototype=Object.create(PIXI.Container.prototype),n.TILE_WIDTH=a,n.TILE_HEIGHT=r,i.exports=n},{}],7:[function(t,i,e){function n(){return(new Date).getTime()}function s(t,i){return t=Math.ceil(t||0),i||(i=t,t=0),Math.floor(Math.random()*(i-t))+t}i.exports={what_time_is_it:n,random_int:s}},{}]},{},[1]);